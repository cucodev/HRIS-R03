
@{
    ViewBag.Title = "Notifications";
    Layout = "~/Views/Shared/_LayoutLeftNav.cshtml";
}

@section scripts
{
    <script src=@Url.Content("~/Scripts/hrisframework/hris.js")></script>
    <script type="text/javascript">
        function dragEnter(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            $(evt.target).addClass('over');
        }

        function dragLeave(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            $(evt.target).removeClass('over');
        }

        function drop(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            $(evt.target).removeClass('over');

            var files = evt.originalEvent.dataTransfer.files;

            if (files.length > 0) {
                if (window.FormData !== undefined) {
                    var data = new FormData();
                    for (i = 0; i < files.length; i++) {
                        //console.log(files[i]);
                        data.append("file" + i, files[i]);
                    }

                    $.ajax({
                        type: "POST",
                        url: "/api/file/UploadImageFiles",
                        contentType: false,
                        processData: false,
                        data: data,
                        success: function (res) {
                            $.each(res, function (i, item) {
                                viewModel.uploads.push(item);
                            });
                        }
                    });
                } else {
                    alert("your browser sucks!");
                }
            }
        }

        $(document).ready(function () {
            var $box = $("#ulbox");

            $box.bind("dragenter", dragEnter);
            $box.bind("dragleave", dragLeave);
            $box.bind("drop", drop);
        });

        var viewModel = { uploads: ko.observableArray([]) }
        ko.applyBindings(viewModel);
    </script>
}



<h2>Notifications</h2>

<div id="ulbox">
    <span>Drop your s*** here...</span>
</div>
<ul data-bind="template: { name: 'upload-template', foreach: uploads }"></ul>
<script type="text/html" id="upload-template">
    <li>
        <span>Uploaded: <small data-bind="text: name"></small>.</span><span>
            Size: <small data-bind="text: size"></small>kB
        </span><span>
            Server path: <a data-bind="attr:{href: path}, text:path">
            </a>
        </span>
    </li>
</script>



<form action="/api/file/UploadImageFiles" method="post" enctype="multipart/form-data">
    <label for="somefile">File</label>
    <input name="somefile" type="file" multiple />
    <input type="submit" value="Submit" />
</form>